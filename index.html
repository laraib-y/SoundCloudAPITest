<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SoundCloud API Tester</title>
    <script src="https://w.soundcloud.com/player/api.js"></script>
    <style>
        #controls {
            margin-top: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        #progress {
            width: 80%;
        }
    </style>
</head>
<body>

    <!-- SoundCloud Playlist Embed -->
    <iframe id="sc-widget" width="100%" height="300" scrolling="no" frameborder="no" allow="autoplay"
        src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/playlists/1715458305&color=%236214ac&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true">
    </iframe>

    <!-- Custom Controls -->
    <div id="controls">
        <button id="prev">⏮ Previous</button>
        <button id="playPause">Play</button>
        <button id="next">⏭ Next</button>
        <input type="range" id="progress" min="0" max="100" value="0">
        <span id="time">0:00 / 0:00</span>
    </div>

    <script>
        // Get the widget iframe and initialize the API
        const widgetIframe = document.getElementById('sc-widget');
        const widget = SC.Widget(widgetIframe);

        // Get controls
        const playPauseBtn = document.getElementById('playPause');
        const prevBtn = document.getElementById('prev');
        const nextBtn = document.getElementById('next');
        const progressBar = document.getElementById('progress');
        const timeDisplay = document.getElementById('time');

        let isPlaying = false;

        // Toggle Play/Pause
        playPauseBtn.addEventListener('click', () => {
            widget.isPaused((paused) => {
                if (paused) {
                    widget.play();
                    playPauseBtn.textContent = "Pause";
                    isPlaying = true;
                } else {
                    widget.pause();
                    playPauseBtn.textContent = "Play";
                    isPlaying = false;
                }
            });
        });

        // Next Track
        nextBtn.addEventListener('click', () => {
            widget.next();
        });

        // Previous Track
        prevBtn.addEventListener('click', () => {
            widget.prev();
        });

        // Update Progress Bar
        widget.bind(SC.Widget.Events.PLAY_PROGRESS, function(event) {
            widget.getDuration(function(duration) {
                const currentTime = event.currentPosition;
                progressBar.value = (currentTime / duration) * 100;

                // Format Time
                function formatTime(ms) {
                    let seconds = Math.floor(ms / 1000);
                    let minutes = Math.floor(seconds / 60);
                    seconds = seconds % 60;
                    return `${minutes}:${seconds.toString().padStart(2, '0')}`;
                }

                timeDisplay.textContent = `${formatTime(currentTime)} / ${formatTime(duration)}`;
            });
        });

        // Seek to Position in Track
        progressBar.addEventListener('input', () => {
            widget.getDuration((duration) => {
                const newTime = (progressBar.value / 100) * duration;
                widget.seekTo(newTime);
            });
        });
    </script>

</body>
</html>
